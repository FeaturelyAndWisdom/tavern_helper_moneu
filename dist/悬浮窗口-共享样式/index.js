import{createPinia as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={140(e,n,t){t.d(n,{A:()=>A});var o=t(16),a=t.n(o),r=t(48),i=t.n(r)()(a());i.push([e.id,'.floating-window{position:fixed;top:100px;right:20px;width:320px;max-height:80vh;z-index:9999;background:var(--SmartThemeBlurTintColor,rgba(30,30,30,0.95));border:1px solid var(--SmartThemeBorderColor,rgba(255,255,255,0.1));border-radius:10px;box-shadow:0 8px 32px rgba(0,0,0,.3);overflow:hidden;display:flex;flex-direction:column}.floating-window__header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--SmartThemeBlurTintColor,rgba(40,40,40,0.9));border-bottom:1px solid var(--SmartThemeBorderColor,rgba(255,255,255,0.08));cursor:move;-webkit-user-select:none;user-select:none}.floating-window__header-left{display:flex;align-items:center;gap:8px;color:var(--SmartThemeBodyColor,#e0e0e0);font-weight:600;font-size:14px}.floating-window__header-left i{color:var(--SmartThemeQuoteColor,#6ca0dc)}.floating-window__header-right{display:flex;align-items:center;gap:4px}.floating-window__btn-icon{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--SmartThemeBodyColor,#e0e0e0);cursor:pointer;transition:background .2s}.floating-window__btn-icon:hover{background:hsla(0,0%,100%,.1)}.floating-window__btn-icon i{font-size:12px}.floating-window__content{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:12px}.floating-window__section{background:hsla(0,0%,100%,.03);border-radius:8px;padding:12px;border:1px solid hsla(0,0%,100%,.05)}.floating-window__section-title{font-size:12px;font-weight:500;color:var(--SmartThemeEmColor,#aaa);margin:0 0 10px 0;text-transform:uppercase;letter-spacing:.5px}.floating-window__actions{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}.floating-window__actions .menu_button{display:flex;align-items:center;justify-content:center;gap:6px;padding:8px 12px;font-size:13px}.floating-window__actions .menu_button i{font-size:12px}.floating-window__info{font-size:13px;color:var(--SmartThemeBodyColor,#ccc);line-height:1.6}.floating-window__info p{margin:0}.floating-window__textarea{width:100%;height:80px;resize:none;font-size:13px;margin-bottom:8px}.floating-window__submit{width:100%;display:flex;align-items:center;justify-content:center;gap:6px}.floating-window__submit i{font-size:12px}','',{version:3,sources:['webpack://./src/悬浮窗口-共享样式/style.scss'],names:[],mappings:'AAGA,iBACE,cAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,eAAA,CACA,YAAA,CACA,6DAAA,CACA,mEAAA,CACA,kBAAA,CACA,oCAAA,CACA,eAAA,CACA,YAAA,CACA,qBAAA,CAEA,yBACE,YAAA,CACA,kBAAA,CACA,6BAAA,CACA,iBAAA,CACA,4DAAA,CACA,2EAAA,CACA,WAAA,CACA,wBAAA,CAAA,gBAAA,CAEA,8BACE,YAAA,CACA,kBAAA,CACA,OAAA,CACA,wCAAA,CACA,eAAA,CACA,cAAA,CAEA,gCACE,yCAAA,CAIJ,+BACE,YAAA,CACA,kBAAA,CACA,OAAA,CAIJ,2BACE,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,wBAAA,CACA,WAAA,CACA,iBAAA,CACA,wCAAA,CACA,cAAA,CACA,yBAAA,CAEA,iCACE,6BAAA,CAGF,6BACE,cAAA,CAIJ,0BACE,MAAA,CACA,eAAA,CACA,YAAA,CACA,YAAA,CACA,qBAAA,CACA,QAAA,CAGF,0BACE,8BAAA,CACA,iBAAA,CACA,YAAA,CACA,oCAAA,CAEA,gCACE,cAAA,CACA,eAAA,CACA,mCAAA,CACA,iBAAA,CACA,wBAAA,CACA,mBAAA,CAIJ,0BACE,YAAA,CACA,mCAAA,CACA,OAAA,CAEA,uCACE,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,OAAA,CACA,gBAAA,CACA,cAAA,CAEA,yCACE,cAAA,CAKN,uBACE,cAAA,CACA,qCAAA,CACA,eAAA,CAEA,yBACE,QAAA,CAIJ,2BACE,UAAA,CACA,WAAA,CACA,WAAA,CACA,cAAA,CACA,iBAAA,CAGF,yBACE,UAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,OAAA,CAEA,2BACE,cAAA',sourcesContent:['// 使用 BEM 命名规范避免与酒馆样式冲突\n// 禁止使用 tailwindcss，使用酒馆原有的 CSS 变量和类名\n\n.floating-window {\n  position: fixed;\n  top: 100px;\n  right: 20px;\n  width: 320px;\n  max-height: 80vh;\n  z-index: 9999;\n  background: var(--SmartThemeBlurTintColor, rgba(30, 30, 30, 0.95));\n  border: 1px solid var(--SmartThemeBorderColor, rgba(255, 255, 255, 0.1));\n  border-radius: 10px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n\n  &__header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 10px 12px;\n    background: var(--SmartThemeBlurTintColor, rgba(40, 40, 40, 0.9));\n    border-bottom: 1px solid var(--SmartThemeBorderColor, rgba(255, 255, 255, 0.08));\n    cursor: move;\n    user-select: none;\n\n    &-left {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      color: var(--SmartThemeBodyColor, #e0e0e0);\n      font-weight: 600;\n      font-size: 14px;\n\n      i {\n        color: var(--SmartThemeQuoteColor, #6ca0dc);\n      }\n    }\n\n    &-right {\n      display: flex;\n      align-items: center;\n      gap: 4px;\n    }\n  }\n\n  &__btn-icon {\n    width: 24px;\n    height: 24px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: transparent;\n    border: none;\n    border-radius: 4px;\n    color: var(--SmartThemeBodyColor, #e0e0e0);\n    cursor: pointer;\n    transition: background 0.2s;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.1);\n    }\n\n    i {\n      font-size: 12px;\n    }\n  }\n\n  &__content {\n    flex: 1;\n    overflow-y: auto;\n    padding: 12px;\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n  }\n\n  &__section {\n    background: rgba(255, 255, 255, 0.03);\n    border-radius: 8px;\n    padding: 12px;\n    border: 1px solid rgba(255, 255, 255, 0.05);\n\n    &-title {\n      font-size: 12px;\n      font-weight: 500;\n      color: var(--SmartThemeEmColor, #aaa);\n      margin: 0 0 10px 0;\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n    }\n  }\n\n  &__actions {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 8px;\n\n    .menu_button {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n      padding: 8px 12px;\n      font-size: 13px;\n\n      i {\n        font-size: 12px;\n      }\n    }\n  }\n\n  &__info {\n    font-size: 13px;\n    color: var(--SmartThemeBodyColor, #ccc);\n    line-height: 1.6;\n\n    p {\n      margin: 0;\n    }\n  }\n\n  &__textarea {\n    width: 100%;\n    height: 80px;\n    resize: none;\n    font-size: 13px;\n    margin-bottom: 8px;\n  }\n\n  &__submit {\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n\n    i {\n      font-size: 12px;\n    }\n  }\n}\n'],sourceRoot:''}]);const A=i},48(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t='',o=void 0!==n[5];return n[4]&&(t+='@supports ('.concat(n[4],') {')),n[2]&&(t+='@media '.concat(n[2],' {')),o&&(t+='@layer'.concat(n[5].length>0?' '.concat(n[5]):'',' {')),t+=e(n),o&&(t+='}'),n[2]&&(t+='}'),n[4]&&(t+='}'),t}).join('')},n.i=function(e,t,o,a,r){'string'==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var A=0;A<this.length;A++){var s=this[A][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var l=[].concat(e[c]);o&&i[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]='@layer'.concat(l[5].length>0?' '.concat(l[5]):'',' {').concat(l[1],'}')),l[5]=r),t&&(l[2]?(l[1]='@media '.concat(l[2],' {').concat(l[1],'}'),l[2]=t):l[2]=t),a&&(l[4]?(l[1]='@supports ('.concat(l[4],') {').concat(l[1],'}'),l[4]=a):l[4]=''.concat(a)),n.push(l))}},n}},16(e){e.exports=function(e){var n=e[1],t=e[3];if(!t)return n;if('function'==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),a='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(o),r='/*# '.concat(a,' */');return[n].concat([r]).join('\n')}return[n].join('\n')}},386(e){var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var r={},i=[],A=0;A<e.length;A++){var s=e[A],c=o.base?s[0]+o.base:s[0],l=r[c]||0,d=''.concat(c,' ').concat(l);r[c]=l+1;var p=t(d),C={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)n[p].references++,n[p].updater(C);else{var f=a(C,o);o.byIndex=A,n.splice(A,0,{identifier:d,updater:f,references:1})}i.push(d)}return i}function a(e,n){var t=n.domAPI(n);t.update(e);return function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,a){var r=o(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<r.length;i++){var A=t(r[i]);n[A].references--}for(var s=o(e,a),c=0;c<r.length;c++){var l=t(r[c]);0===n[l].references&&(n[l].updater(),n.splice(l,1))}r=s}}},537(e){var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insert\' parameter is invalid.');o.appendChild(t)}},6(e){e.exports=function(e){var n=document.createElement('style');return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},778(e,n,t){e.exports=function(e){var n=t.nc;n&&e.setAttribute('nonce',n)}},499(e){e.exports=function(e){if('undefined'==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o='';t.supports&&(o+='@supports ('.concat(t.supports,') {')),t.media&&(o+='@media '.concat(t.media,' {'));var a=void 0!==t.layer;a&&(o+='@layer'.concat(t.layer.length>0?' '.concat(t.layer):'',' {')),o+=t.css,a&&(o+='}'),t.media&&(o+='}'),t.supports&&(o+='}');var r=t.sourceMap;r&&'undefined'!=typeof btoa&&(o+='\n/*# sourceMappingURL=data:application/json;base64,'.concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))),' */')),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},571(e){e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}},t={};function o(e){var a=t[e];if(void 0!==a)return a.exports;var r=t[e]={id:e,exports:{}};return n[e](r,r.exports,o),r.exports}o.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return o.d(n,{a:n}),n},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.nc=void 0;const a=Vue,r={class:'floating-window'},i={class:'floating-window__header'},A={class:'floating-window__header-right'},s={class:'floating-window__content'},c={class:'floating-window__section'},l={class:'floating-window__actions'},d=['onClick'],p={class:'floating-window__section'},C={class:'floating-window__info'},f={class:'floating-window__section'},u=(0,a.defineComponent)({__name:'Window',setup(e){const n=(0,a.ref)(!1),t=(0,a.ref)(''),o=(0,a.ref)(null),u=(0,a.ref)(0),m=[{name:'刷新',icon:'fas fa-sync-alt',action:'refresh'},{name:'清空',icon:'fas fa-trash',action:'clear'},{name:'保存',icon:'fas fa-save',action:'save'},{name:'设置',icon:'fas fa-cog',action:'settings'}];function g(){o.value=SillyTavern.getCurrentChatId(),u.value=getLastMessageId()+1}function x(){t.value.trim()?(toastr.success(`已发送: ${t.value}`),t.value=''):toastr.warning('请输入内容')}return(0,a.onMounted)(()=>{g(),eventOn(tavern_events.CHAT_CHANGED,g),eventOn(tavern_events.MESSAGE_RECEIVED,g)}),(e,w)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',r,[(0,a.createCommentVNode)(' 窗口标题栏 '),(0,a.createElementVNode)('div',i,[w[2]||(w[2]=(0,a.createElementVNode)('div',{class:'floating-window__header-left'},[(0,a.createElementVNode)('i',{class:'fas fa-window-maximize'}),(0,a.createElementVNode)('span',null,'悬浮窗口')],-1)),(0,a.createElementVNode)('div',A,[(0,a.createElementVNode)('button',{class:'floating-window__btn-icon',onClick:w[0]||(w[0]=e=>n.value=!(0,a.unref)(n))},[(0,a.createElementVNode)('i',{class:(0,a.normalizeClass)((0,a.unref)(n)?'fas fa-chevron-down':'fas fa-chevron-up')},null,2)])])]),(0,a.createCommentVNode)(' 窗口内容区 '),(0,a.withDirectives)((0,a.createElementVNode)('div',s,[(0,a.createCommentVNode)(' 快捷操作 '),(0,a.createElementVNode)('div',c,[w[3]||(w[3]=(0,a.createElementVNode)('h3',{class:'floating-window__section-title'},'快捷操作',-1)),(0,a.createElementVNode)('div',l,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m,e=>(0,a.createElementVNode)('button',{key:e.name,class:'menu_button',onClick:n=>function(e){switch(e.action){case'refresh':g(),toastr.info('已刷新信息');break;case'clear':t.value='',toastr.info('已清空输入');break;case'save':toastr.success('保存成功');break;case'settings':toastr.info('设置功能待实现')}}(e)},[(0,a.createElementVNode)('i',{class:(0,a.normalizeClass)(e.icon)},null,2),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.name),1)],8,d)),64))])]),(0,a.createCommentVNode)(' 信息面板 '),(0,a.createElementVNode)('div',p,[w[4]||(w[4]=(0,a.createElementVNode)('h3',{class:'floating-window__section-title'},'信息面板',-1)),(0,a.createElementVNode)('div',C,[(0,a.createElementVNode)('p',null,'当前聊天: '+(0,a.toDisplayString)((0,a.unref)(o)??'无'),1),(0,a.createElementVNode)('p',null,'消息数量: '+(0,a.toDisplayString)((0,a.unref)(u)),1)])]),(0,a.createCommentVNode)(' 输入区域 '),(0,a.createElementVNode)('div',f,[w[6]||(w[6]=(0,a.createElementVNode)('h3',{class:'floating-window__section-title'},'输入区域',-1)),(0,a.withDirectives)((0,a.createElementVNode)('textarea',{'onUpdate:modelValue':w[1]||(w[1]=e=>(0,a.isRef)(t)?t.value=e:null),class:'text_pole floating-window__textarea',placeholder:'在此输入内容...'},null,512),[[a.vModelText,(0,a.unref)(t)]]),(0,a.createElementVNode)('button',{class:'menu_button floating-window__submit',onClick:x},[...w[5]||(w[5]=[(0,a.createElementVNode)('i',{class:'fas fa-paper-plane'},null,-1),(0,a.createTextVNode)(' 发送 ',-1)])])])],512),[[a.vShow,!(0,a.unref)(n)]])]))}});var m=o(386),g=o.n(m),x=o(499),w=o.n(x),h=o(537),v=o.n(h),b=o(778),y=o.n(b),E=o(6),B=o.n(E),S=o(571),T=o.n(S),N=o(140),k={};k.styleTagTransform=T(),k.setAttributes=y(),k.insert=v().bind(null,'head'),k.domAPI=w(),k.insertStyleElement=B();g()(N.A,k);N.A&&N.A.locals&&N.A.locals;$(()=>{const n=(0,a.createApp)(u).use(e()),t=$('<div>').attr('script_id',getScriptId()).appendTo('body');n.mount(t[0]);const{destroy:o}=function(e='head'){const n=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo(e);return{destroy:()=>n.remove()}}();t.find('.floating-window').draggable({handle:'.floating-window__header',containment:'window'}),appendInexistentScriptButtons([{name:'切换窗口',visible:!0}]),eventOn(getButtonEvent('切换窗口'),()=>{t.toggle()}),$(window).on('pagehide',()=>{n.unmount(),t.remove(),o()})});
//# sourceMappingURL=index.js.map